<!DOCTYPE html>
<html>
<head>
  <title><%= title %></title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1>Employee List</h1>
    <div>
      <a href="/employees/new" class="btn btn-success me-2">Add Employee</a>
      <a href="/employees/bulk" class="btn btn-primary me-2">Bulk Upload</a>
    <a href="/employees/download-csv" class="btn btn-secondary me-2">Download CSV</a>

    </div>
  </div>

  <!-- Search Form -->
  <form class="d-flex mb-3" method="get" action="/employees">
    <input type="text" name="q" value="<%= q || '' %>" class="form-control me-2" placeholder="Search by name or email">
    <button class="btn btn-outline-primary">Search</button>
  </form>


  <!-- Employee Table -->
  <table class="table table-bordered">
    <thead class="table-light">
      <tr>
        <th>S.No.</th>
        <th>Name</th>
        <th>Email</th>
        <th>Age</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% if (employees.length === 0) { %>
        <tr><td colspan="5" class="text-center">No employees found</td></tr>
      <% } %>
      <% employees.forEach((emp, index) => { %>
        <tr>
          <td><%= (current - 1) * 10 + (index + 1) %></td> <!-- âœ… Serial continues across pages -->
          <td><a href="/employees/<%= emp._id %>"><%= emp.name %></a></td>
          <td><%= emp.email %></td>
          <td><%= emp.age || "-" %></td>
          <td>
            <a href="/employees/<%= emp._id %>/edit" class="btn btn-sm btn-warning">Edit</a>
            <form action="/employees/<%= emp._id %>?_method=DELETE" method="post" style="display:inline;">
              <button class="btn btn-sm btn-danger" onclick="return confirm('Delete this employee?')">Delete</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
    <!--Pagination -->
<% const maxPagesToShow = 20; %>
<% const startPage = Math.max(1, current - 2); %>
<% const endPage = Math.min(pages, current + 2); %>

<nav aria-label="Page navigation">
  <ul class="pagination">


    <!-- ðŸ”¹ Previous -->
    <% if (current > 1) { %>
      <li class="page-item">
        <a class="page-link" href="?page=<%= current - 1 %>&q=<%= q %>">Previous</a>

      </li>
    <% } else { %>
      <li class="page-item disabled"><span class="page-link">Previous</span></li>
    <% } %>

    <!-- ðŸ”¹ Page Numbers -->
    <% for (let i= startPage; i <= endPage; i++) { %>
      <li class="page-item <%= i === current ? 'active' : '' %>">
        <a class="page-link" href="?page=<%= i %>&q=<%= q %>"><%= i %></a>
      </li>
    <% } %>

    <% if (endPage < pages) { %>
      <li class="page-item disabled"><span class="page-link">...</span></li>
      <li class="page-item">
        <a class="page-link" href="?page=<%= pages %>&q=<%= q %>"><%= pages %></a>
      </li>
    <% } %>

    <!-- ðŸ”¹ Next -->
    <% if (current < pages) { %>
      <li class="page-item">
        <a class="page-link" href="?page=<%= current + 1 %>&q=<%= q %>">Next</a>
      </li>
    <% } else { %>
      <li class="page-item disabled"><span class="page-link">Next</span></li>
    <% } %>

  
  </ul>
</nav>




</body>
</html>
